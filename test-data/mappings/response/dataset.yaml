---
request:
  url: /datasets/tickets
  method: GET
response:
  status: 200
  dataset: tickets
  jsonataExpression: $ ~> | $ | {}, ['context', 'resolution', 'resolutionTimestamp'] |
---
request:
  urlPathPattern: /datasets/tickets/.+
  method: GET
response:
  status: 200
  dataset: tickets
  jsonataExpression: $[ticketId=$request.pathSegments[2]]
---
request:
  urlPathPattern: /datasets/tickets/.+
  method: PUT
processing:
  - type: input
    dataset: tickets
    expression: $
  - type: match
    expression: $[ticketId=$request.pathSegments[2]]
  - type: store
    operation: replaceWithRequestBody
  - type: response
    output: currentData
response:
  status: 200
  jsonataExpression: $[ticketId=$request.pathSegments[2]]
---
request:
  urlPathPattern: /datasets/tickets/.+
  method: DELETE
processing:
  - type: input
    dataset: tickets
    expression: $
  - type: match
    expression: $[ticketId=$request.pathSegments[2]]
  - type: store
    operation: deleteMatching
response:
  status: 200
  body: OK
---
request:
  urlPathPattern: /datasets/tickets/.+
  method: PATCH
processing:
  - type: input
    dataset: tickets
    expression: $
  - type: match
    expression: $[ticketId=$request.pathSegments[2]]
  - type: store
    operation: mergeWithRequestBody
  - type: response
    output: currentData
response:
  status: 200
---
request:
  url: /datasets/tickets
  method: POST
processing:
  - type: input
    dataset: tickets
    expression: $
  - type: transform
    input: requestBody
    expression: '$merge([$, {"ticketId": $uuid()}])'
  - type: store
    operation: insertRequestBody
  - type: response
    output: currentData
response:
  status: 200
